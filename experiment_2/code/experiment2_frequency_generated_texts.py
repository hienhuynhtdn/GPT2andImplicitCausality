# -*- coding: utf-8 -*-
"""
Created on Mon Jun 27 14:46:35 2022

@author: Hien Huynh
"""

#%% IMPORT PACKAGES
import pandas as pd

#%% IMPORT DATAFRAME
df = pd.read_excel('./data/experiment2_textgeneration.xlsx')

#%% FUNCTIONS

def split_sentence(sentence, separator):
    sentence = sentence.split(separator)[-1]
    
    # REMOVE SPACE AT THE BEGINNING OF STRING AND PUNCTUATION AT THE END
    sentence = sentence[1:-1]
    
    return sentence

#%% ANALYZE MOST FREQUENT TEXT GENERATIONS

# RAW OUTPUTS GENERATED BY THE MODEL
df['continuation'] = df['output'].apply(
    lambda x: split_sentence(x, 'because'))
# FREQUENCY OF RAW OUTPUTS BY SUBJECT GENDER
continuation_df = pd.DataFrame(df.groupby(['subject_gender','continuation']).size())
continuation_df = continuation_df.reset_index(drop=False)
continuation_df.rename(columns={0:'count'},inplace=True)
continuation_df = continuation_df.sort_values(by=['subject_gender','count'],ascending=False)
continuation_df = continuation_df.reset_index(drop=True)